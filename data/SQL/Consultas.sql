-- RFC 1
SELECT idSucursal, SUM(total)
FROM FACTURA
WHERE fecha BETWEEN '31/10/18' AND '11/11/18'
GROUP BY idSucursal 
ORDER BY idSucursal;

--RFC 2
SELECT * FROM PROMOCION;
SELECT * FROM PROMOCION 
WHERE rownum <= 20 
ORDER BY cantidadproductosvendidos DESC;

--RFC 3
SELECT ESTANTE.id, J.totVol/ESTANTE.volumen *100, J.totPeso/ESTANTE.peso * 100 
FROM (
SELECT ESTANTE.id, NVL((SUM(PRODUCTO.volEmpaque * PRODUCTOESTANTE.cantidad)), 0) AS TOTVOL, NVL((SUM(PRODUCTO.pesoEmpaque * PRODUCTOESTANTE.cantidad)),0) AS TOTPESO
FROM ESTANTE
LEFT OUTER JOIN PRODUCTOESTANTE ON ESTANTE.id = PRODUCTOESTANTE.idEstante
LEFT OUTER JOIN PRODUCTO ON PRODUCTOESTANTE.idProducto = PRODUCTO.id 
WHERE ESTANTE.idSucursal = 38 
GROUP BY ESTANTE.id) J
INNER JOIN ESTANTE ON J.id = ESTANTE.id;

SELECT BODEGA.id, J.totVol/BODEGA.volumen *100, J.totPeso/BODEGA.peso * 100 
FROM (
SELECT BODEGA.id, NVL((SUM(PRODUCTO.volEmpaque * PRODUCTOBODEGA.cantidad)), 0) AS TOTVOL, NVL((SUM(PRODUCTO.pesoEmpaque * PRODUCTOBODEGA.cantidad)),0) AS TOTPESO
FROM BODEGA
LEFT OUTER JOIN PRODUCTOBODEGA ON BODEGA.id = PRODUCTOBODEGA.idBodega
LEFT OUTER JOIN PRODUCTO ON PRODUCTOBODEGA.idProducto = PRODUCTO.id 
WHERE BODEGA.idSucursal = 38 
GROUP BY BODEGA.id) J
INNER JOIN BODEGA ON J.id = BODEGA.id;

--RFC 5
SELECT * FROM ORDEN 
GROUP BY IDPROVEEDOR;
--RFC 6
SELECT * FROM FACTURA 
WHERE IDCLIENTE = 1018510315 AND FECHA BETWEEN '31/10/18' AND '11/11/18';

-- RFC 7
SELECT idSucursal,to_date(fecha, 'DD/MM/YY') AS FECHA, TIPOPRODUCTO.NOMBRE, sum(univendidas) AS CANTIDAD_VENDIDA, sum (total)AS TOTAL_INGRESOS FROM FACTURA 
INNER JOIN FACTURAPRODUCTO ON FACTURAPRODUCTO.IDFACTURA = FACTURA.ID 
INNER JOIN PRODUCTO ON FACTURAPRODUCTO.IDPRODUCTO = PRODUCTO.ID 
INNER JOIN TIPOPRODUCTO ON PRODUCTO.IDTIPOPRODUCTO = TIPOPRODUCTO.ID
where idTipoProducto = 12 AND to_date(fecha, 'DD/MM/YY') BETWEEN '31/10/18' AND '11/11/18'
group by idSucursal,to_date(fecha, 'DD/MM/YY'), TIPOPRODUCTO.NOMBRE ORDER BY TOTAL_INGRESOS DESC;

--RFC 8
SELECT * FROM (
SELECT CLIENTE.NOMBRE, IDCLIENTE, EXTRACT(month FROM factura.fecha) AS MES, COUNT(FACTURA.ID) AS COMPRAS
FROM CLIENTE INNER JOIN FACTURA ON CLIENTE.ID = FACTURA.IDCLIENTE
WHERE FACTURA.idsucursal = 38
group by cliente.nombre, idcliente, EXTRACT(month FROM factura.fecha))
WHERE  COMPRAS >=2;
