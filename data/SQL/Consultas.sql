-- RFC 1
SELECT * FROM FACTURA;
SELECT SUM(TOTAL) FROM FACTURA WHERE IDSUCURSAL=38 AND fecha BETWEEN '31/10/18' AND '11/11/18';

--RFC 2
SELECT * FROM PROMOCION;
SELECT * FROM PROMOCION WHERE rownum <= 20 ORDER BY cantidadproductosvendidos DESC;

--RFC 3
SELECT * FROM BODEGA;

--RFC 5
SELECT * FROM ORDEN GROUP BY IDPROVEEDOR;
--RFC 6
SELECT * FROM FACTURA WHERE IDCLIENTE = 1018510315 AND fecha BETWEEN '31/10/18' AND '11/11/18';

-- RFC 7
SELECT idSucursal,to_date(fecha, 'DD/MM/YY') AS FECHA, TIPOPRODUCTO.NOMBRE, sum(univendidas) AS CANTIDAD_VENDIDA, sum (total)AS TOTAL_INGRESOS FROM FACTURA 
INNER JOIN FACTURAPRODUCTO ON FACTURAPRODUCTO.IDFACTURA = FACTURA.ID 
INNER JOIN PRODUCTO ON FACTURAPRODUCTO.IDPRODUCTO = PRODUCTO.ID 
INNER JOIN TIPOPRODUCTO ON PRODUCTO.IDTIPOPRODUCTO = TIPOPRODUCTO.ID
where idTipoProducto = 12 AND to_date(fecha, 'DD/MM/YY') BETWEEN '31/10/18' AND '11/11/18'
group by idSucursal,to_date(fecha, 'DD/MM/YY'), TIPOPRODUCTO.NOMBRE ORDER BY TOTAL_INGRESOS DESC;

--RFC 8
SELECT * FROM (
SELECT CLIENTE.NOMBRE, IDCLIENTE, EXTRACT(month FROM factura.fecha) AS MES, COUNT(FACTURA.ID) AS COMPRAS
FROM CLIENTE INNER JOIN FACTURA ON CLIENTE.ID = FACTURA.IDCLIENTE
WHERE FACTURA.idsucursal = 38
group by cliente.nombre, idcliente, EXTRACT(month FROM factura.fecha))
WHERE  COMPRAS >=2;
